{# dashboard/partials/today_card.html #}

{% if quest_locked %}

<div class="quest-locked-box">
    <p class="quest-locked-title">クエストは未解放です</p>
    <p class="quest-locked-msg">{{ quest_lock_reason }}</p>

</div>

{% elif items|length == 0 %}
<div class="quest-empty-box">
    <p>今日のクエストがまだありません。</p>
</div>

{% else %}
<div class="quest-board-grid">
    {% for item in items %}
    <div class="quest-card {{ item.quest.difficulty }}">
        
        {% if item.id in my_done_ids %}
        <span class="done-stamp">CLEAR!</span>
        {% endif %}

        <div class="quest-card-content">
            <div class="quest-main-info">
                <h4 class="quest-name">{{ item.quest.name }}</h4>
                <span class="quest-points">+{{ item.quest.points }}pt</span>
            </div>
            <div class="quest-footer">
            <span class="difficulty-label">{{ item.quest.difficulty|upper }}</span>
        </div>
        
    </div>

    
    <div class="quest-action">
        {% if item.id not in my_done_ids %} 
        <form action="{% url 'quests:complete' item.id %}" method="POST">
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.get_full_path }}">
                <button type="submit" class="btn-complete-circle">✓</button>    
        </form>
        {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
